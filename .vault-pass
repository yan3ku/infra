#!/bin/sh
set -eu
# When run by ansible, this is run from the root of the ansible directory
# But when run by git in a smudge filter, it's run from the root of the git repo
# So we have to look for .vault-pass.gpg in two relative places
if test -e .vault-pass.gpg; then
    vp=.vault-pass.gpg
elif test -e ansible/.vault-pass.gpg; then
    vp=ansible/.vault-pass.gpg
else
    echo "CANNOT FIND .vault-pass.gpg FROM PWD $(pwd)"
    exit 1
fi
gpg --quiet --decrypt "$vp"
